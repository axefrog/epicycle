export function makePageDriver(domDriver) {
  return function pageDriver(page$) {
    page$ = page$.multicast();
    const view$ = page$
      .filter(p => p.view)
      .map(p => p.view);

    const DOM = domDriver(view$);
    return {
      page$,
      DOM
    };
  };
}

export function makeBrowserPageDriver(domDriver) {
  function setTitle(title) {
    document.title = title;
  }

  return function(page$) {
    page$ = page$.multicast();
    const pageDriver = makePageDriver(domDriver);
    const source = pageDriver(page$);

    source.page$
      .filter(p => p.title)
      .map(p => p.title)
      .observe(setTitle);

    return source;
  };
}
